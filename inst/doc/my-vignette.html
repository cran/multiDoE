<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Multi-stratum experimental designs: a practical example</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Multi-stratum experimental designs: a
practical example</h1>



<div id="the-multidoe-package" class="section level3">
<h3>The <code>MultiDoE</code> package</h3>
<p>The <code>MultiDoE</code> package can be used to construct
multi-stratum experimental designs (for any number of strata) that
optimize up to six statistical criteria simultaneously. To solve such
optimization problems, the innovative MS-Opt and MS-TPLS algorithms are
implemented. The former relies on a local search procedure to find a
locally optimal experimental design. More precisely, it is an extension
of the Coordinate-Exchange (CE) algorithm that allows both the search of
experimental designs for any type of nested multi-stratum experiment and
the optimization of multiple criteria simultaneously. The latter, by
embedding MS-Opt in a Two-Phase Local Search framework, is able to
generate a good Pareto front approximation for the optimization problem
under study. The package provides different ways to choose the final
optimal experimental design among those belonging to the Pareto
front.</p>
<p>In what follows, we report a practical example.</p>
</div>
<div id="the-protein-extraction-experiment" class="section level3">
<h3>The protein extraction experiment</h3>
<p>In this experiment, a split-plot design is used. The final aim is to
investigate the effect of five factors on protein extraction. More
precisely, a mixture containing two valuable proteins, among other
components, is considered after fermentation and purification
processes.</p>
<p>The experiment is intended to separate the two proteins from the
mixture, and the responses were the yields and purities of the two
proteins. The factors are: <span class="math inline">\(x_1\)</span>, the
feed position for the inflow of a mixture, which is hard to set; <span class="math inline">\(x_2\)</span> the feed flow rate; <span class="math inline">\(x_3\)</span> the gas flow rate; <span class="math inline">\(x_4\)</span> the concentration of the first
protein; <span class="math inline">\(x_5\)</span>, the concentration of
the second protein. Three levels are used for each factor. The
split-plot design was set up as follows: one whole-plot factor, four
subplot factors, twenty-one whole plots of size two, and 42 runs.</p>
<p>Let use the package for simultaneously optmize more than one
criterion.</p>
<p>First step is to upload the package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(multiDoE)</span></code></pre></div>
<p>It is time to initialize the main arguments for defining the
experimental design.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>backup_options <span class="ot">&lt;-</span> <span class="fu">options</span>()</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">15</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>facts <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">21</span>, <span class="dv">2</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>levels <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>etas <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>criteria <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Id&#39;</span>, <span class="st">&#39;Ds&#39;</span>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">&quot;quadratic&quot;</span></span></code></pre></div>
<p><code>facts</code> is a list of vectors representing the distribution
of factors across strata. Each item in the list represents a stratum and
the first item is the highest stratum of the multi-stratum structure of
the experiment. Within the vectors, experimental factors are indicated
by progressive integer from 1 (the first factor of the highest stratum)
to the total number of experimental factors (the last factor of the
lowest stratum). Blocking factors are differently denoted by empty
vectors.</p>
<p><code>units</code> is a list whose <span class="math inline">\(i\)</span>-th element, <span class="math inline">\(n_i\)</span>, is the number of experimental units
within each unit at the previous stratum (<span class="math inline">\(i-1\)</span>).</p>
<p><code>levels</code> is the number of available levels for each
experimental factor.</p>
<p><code>etas</code> is used to specify the ratios of error variance
between subsequent strata, starting from the highest strata.</p>
<p><code>criteria</code> is a list specifying the criteria to be
optimized among I-, Id-, D-, A-, Ds, and As-optimality.</p>
<p><code>model</code> is a string which indicates the type of model,
among main effects only (“main”), interaction (“interaction”) and full
quadratic (“quadratic”).</p>
<p>Now, we need to declare the main arguments for the MS-TPLS algorithms
in order to get the final Pareto Front.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>iters <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">*</span> <span class="fu">length</span>(criteria)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>restarts <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>restInit <span class="ot">&lt;-</span> <span class="dv">2</span></span></code></pre></div>
<p><code>model</code> is an integer indicating the number of iterations
of the MS-TPLS algorithm. In this case, we set the iteration as 5 times
the number of criteria.</p>
<p><code>restarts</code> defines the number of times the MS-Opt
procedure is altogether called within each iteration of the MS-TPLS
algorithm.</p>
<p><code>restInit</code> determines how many of the iterations of MS-Opt
should be used for each criterion in the first step of the MS-TPLS
algorithm.</p>
<p><code>restarts</code> and <code>restInit</code>could be tuned.</p>
<p>We now simultaneously minimize Id- and Ds-criteria.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>tpls <span class="ot">&lt;-</span> <span class="fu">runTPLS</span>(facts,units, criteria, model, iters, </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                <span class="st">&quot;Restarts&quot;</span>, restarts, </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                <span class="st">&quot;RestInit&quot;</span>, restInit)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; [1] 3</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; [1] 6</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; [1] 7</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; [1] 8</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; [1] 9</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<p>Given the <code>tpls</code> object, you have now different options.
First of all, you can inspect your Pareto front by using the
<code>plotPareto</code> function. As input of the
<code>plotPareto</code> function, you should use the <code>megaAr</code>
output of the <code>runTPLS</code> function. <code>megaAR</code>
contains different information, among them it includes a matrix on which
every row contains the criteria values for each Pareto front design.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">plotPareto</span>(tpls<span class="sc">$</span>megaAR)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Now, you would probably like to find the best compromise between Id-
and Ds-criteria. For this purpose, the <code>optMultiCrit</code> is the
function you are searching for. The <code>optMultiCrit</code> function
provides an objective criterion for the selection of the best
experimental design among all Pareto front solutions. The selection is
based on minimizing the euclidean distance in the criteria space between
all the Pareto front points and an approximate utopian point. By
default, the coordinates of the utopian point correspond to the minimum
value reached by each criterion during the <code>runTPLS</code>
optimization procedure. Alternatively, the utopian point can be chosen
by the user (please see the documentation).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">optMultiCrit</span>(tpls<span class="sc">$</span>megaAR)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; $solution</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; $solution[[1]]</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5]</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt;  [1,]    1    1    1    1   -1</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt;  [2,]    1   -1   -1    1    0</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt;  [3,]    0    0   -1    0    0</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt;  [4,]    0   -1    0    1    1</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt;  [5,]    1    0    0    0    0</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt;  [6,]    1    1   -1   -1    1</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt;  [7,]    0    1    0   -1    0</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt;  [8,]    0    0    1    0    1</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt;  [9,]    1   -1   -1   -1    1</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; [10,]    1    1    1   -1    1</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; [11,]   -1   -1    1    1    1</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; [12,]   -1   -1   -1   -1    0</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; [13,]    0    0    1    1   -1</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; [14,]    0    1    0    0    0</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; [15,]   -1    1   -1   -1   -1</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; [16,]   -1   -1    0    1    0</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; [17,]    0    1    0    0    1</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt; [18,]    0    0    1   -1    0</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt; [19,]    1   -1    1    1    0</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt; [20,]    1    1   -1    1   -1</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt; [21,]    1   -1   -1   -1   -1</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#&gt; [22,]    1    0   -1    1    1</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt; [23,]   -1    1   -1    1    1</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co">#&gt; [24,]   -1    0    0    0   -1</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#&gt; [25,]    0    1   -1    0    0</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co">#&gt; [26,]    0    0    0   -1   -1</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="co">#&gt; [27,]    1    1    1   -1   -1</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co">#&gt; [28,]    1   -1    0    1   -1</span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="co">#&gt; [29,]   -1    1    1    0   -1</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="co">#&gt; [30,]   -1   -1    1   -1    1</span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="co">#&gt; [31,]    0    0    0    0    0</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="co">#&gt; [32,]    0   -1   -1    1   -1</span></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a><span class="co">#&gt; [33,]   -1    1    1    1    0</span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a><span class="co">#&gt; [34,]   -1   -1   -1    0    1</span></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a><span class="co">#&gt; [35,]    1    0   -1   -1   -1</span></span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a><span class="co">#&gt; [36,]    1   -1    1   -1    1</span></span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a><span class="co">#&gt; [37,]   -1   -1    1   -1   -1</span></span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a><span class="co">#&gt; [38,]   -1    0    0   -1    1</span></span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a><span class="co">#&gt; [39,]   -1    1    1   -1    1</span></span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a><span class="co">#&gt; [40,]   -1    0   -1    1   -1</span></span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a><span class="co">#&gt; [41,]    1   -1    1    0   -1</span></span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a><span class="co">#&gt; [42,]    1    1    1    1    1</span></span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a><span class="co">#&gt; $scores</span></span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a><span class="co">#&gt;                 Id                 Ds </span></span>
<span id="cb6-51"><a href="#cb6-51" tabindex="-1"></a><span class="co">#&gt; 0.3327840041018626 0.0784106692294139</span></span></code></pre></div>
<p>Another option is the use of the <code>topsisOpt</code> function.
This approach is based on the principle that the best solutions must be
near to a positive ideal solution <span class="math inline">\((I+)\)</span> and far from a negative ideal
solution <span class="math inline">\((I-)\)</span> in the criteria
space. Please see the main reference for more details.</p>
<p>M. Méndez, M. Frutos, F. Miguel and R. Aguasca-Colomo. TOPSIS
Decision on Approximate Pareto Fronts by Using Evolutionary Algorithms:
Application to an Engineering Design Problem. Mathematics, 2020.</p>
<p>You can access the scores of the best compromised design found by the
TOPSIS procedure.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>topsis_solutions <span class="ot">&lt;-</span> <span class="fu">topsisOpt</span>(tpls)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>topsis_solutions<span class="sc">$</span>bestScore</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt;                 Id                 Ds </span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; 0.3357919136841818 0.0778816088473012</span></span></code></pre></div>
<p>Then, you can also investigate the best design matrix.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>topsis_solutions<span class="sc">$</span>bestSol</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5]</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt;  [1,]    1    1    0    0    0</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt;  [2,]    1   -1   -1    1   -1</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt;  [3,]    0    0    0    0    0</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;  [4,]    0   -1    1   -1   -1</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt;  [5,]    1    1    1    1    1</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt;  [6,]    1   -1   -1    0    1</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt;  [7,]   -1   -1    1   -1    1</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt;  [8,]   -1    0   -1    0   -1</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt;  [9,]    1    1    1   -1    1</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; [10,]    1   -1    0   -1   -1</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; [11,]   -1   -1   -1   -1    1</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; [12,]   -1    1    1    1    1</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; [13,]   -1    1    1    1   -1</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; [14,]   -1   -1   -1   -1   -1</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; [15,]   -1    0    1   -1    0</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; [16,]   -1   -1   -1    1    1</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; [17,]   -1    1    0   -1    0</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; [18,]   -1   -1    1    1   -1</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; [19,]    0    1    1    0    0</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; [20,]    0    0    0    1    1</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt; [21,]    1    0   -1   -1    1</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt; [22,]    1    1   -1    0    0</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt; [23,]    1    0    1   -1   -1</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt; [24,]    1    1   -1    1    1</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; [25,]    1   -1    1   -1    1</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt; [26,]    1    1    1    1   -1</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt; [27,]   -1    1   -1    1   -1</span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt; [28,]   -1    0    1    0    1</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt; [29,]    0    1    0   -1    1</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt; [30,]    0   -1    1    1    1</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt; [31,]   -1    1   -1   -1    1</span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co">#&gt; [32,]   -1    1    1   -1   -1</span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="co">#&gt; [33,]    1    1   -1   -1   -1</span></span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a><span class="co">#&gt; [34,]    1   -1    1    1    0</span></span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a><span class="co">#&gt; [35,]    0   -1   -1   -1    0</span></span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a><span class="co">#&gt; [36,]    0    0    0    0   -1</span></span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a><span class="co">#&gt; [37,]    0    1   -1   -1   -1</span></span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a><span class="co">#&gt; [38,]    0    0    0    0    0</span></span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a><span class="co">#&gt; [39,]    0    0   -1    1    0</span></span>
<span id="cb8-42"><a href="#cb8-42" tabindex="-1"></a><span class="co">#&gt; [40,]    0   -1    0    0   -1</span></span>
<span id="cb8-43"><a href="#cb8-43" tabindex="-1"></a><span class="co">#&gt; [41,]   -1   -1    0    1    0</span></span>
<span id="cb8-44"><a href="#cb8-44" tabindex="-1"></a><span class="co">#&gt; [42,]   -1    1   -1    0    1</span></span></code></pre></div>
<p>At this point, another interesting analysis is related to the
identification of the best design matrices for each criterion in the
Pareto front. <code>optSingleCrit</code> function selects he best design
from the Pareto Front for each criterion.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">optSingleCrit</span>(tpls<span class="sc">$</span>megaAR)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; $Id</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; $Id$scores</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt;                 Id                 Ds </span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; 0.3327840041018626 0.0784106692294139 </span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; $Id$solution</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5]</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt;  [1,]    1    1    1    1   -1</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt;  [2,]    1   -1   -1    1    0</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt;  [3,]    0    0   -1    0    0</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt;  [4,]    0   -1    0    1    1</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt;  [5,]    1    0    0    0    0</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt;  [6,]    1    1   -1   -1    1</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt;  [7,]    0    1    0   -1    0</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt;  [8,]    0    0    1    0    1</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt;  [9,]    1   -1   -1   -1    1</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; [10,]    1    1    1   -1    1</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; [11,]   -1   -1    1    1    1</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; [12,]   -1   -1   -1   -1    0</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; [13,]    0    0    1    1   -1</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; [14,]    0    1    0    0    0</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; [15,]   -1    1   -1   -1   -1</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; [16,]   -1   -1    0    1    0</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; [17,]    0    1    0    0    1</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; [18,]    0    0    1   -1    0</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; [19,]    1   -1    1    1    0</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; [20,]    1    1   -1    1   -1</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; [21,]    1   -1   -1   -1   -1</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; [22,]    1    0   -1    1    1</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; [23,]   -1    1   -1    1    1</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; [24,]   -1    0    0    0   -1</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="co">#&gt; [25,]    0    1   -1    0    0</span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt; [26,]    0    0    0   -1   -1</span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co">#&gt; [27,]    1    1    1   -1   -1</span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="co">#&gt; [28,]    1   -1    0    1   -1</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="co">#&gt; [29,]   -1    1    1    0   -1</span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="co">#&gt; [30,]   -1   -1    1   -1    1</span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a><span class="co">#&gt; [31,]    0    0    0    0    0</span></span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a><span class="co">#&gt; [32,]    0   -1   -1    1   -1</span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a><span class="co">#&gt; [33,]   -1    1    1    1    0</span></span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a><span class="co">#&gt; [34,]   -1   -1   -1    0    1</span></span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a><span class="co">#&gt; [35,]    1    0   -1   -1   -1</span></span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a><span class="co">#&gt; [36,]    1   -1    1   -1    1</span></span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a><span class="co">#&gt; [37,]   -1   -1    1   -1   -1</span></span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a><span class="co">#&gt; [38,]   -1    0    0   -1    1</span></span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a><span class="co">#&gt; [39,]   -1    1    1   -1    1</span></span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a><span class="co">#&gt; [40,]   -1    0   -1    1   -1</span></span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a><span class="co">#&gt; [41,]    1   -1    1    0   -1</span></span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a><span class="co">#&gt; [42,]    1    1    1    1    1</span></span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-53"><a href="#cb9-53" tabindex="-1"></a><span class="co">#&gt; $Ds</span></span>
<span id="cb9-54"><a href="#cb9-54" tabindex="-1"></a><span class="co">#&gt; $Ds$scores</span></span>
<span id="cb9-55"><a href="#cb9-55" tabindex="-1"></a><span class="co">#&gt;                 Id                 Ds </span></span>
<span id="cb9-56"><a href="#cb9-56" tabindex="-1"></a><span class="co">#&gt; 0.4112907857518298 0.0741784584427386 </span></span>
<span id="cb9-57"><a href="#cb9-57" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-58"><a href="#cb9-58" tabindex="-1"></a><span class="co">#&gt; $Ds$solution</span></span>
<span id="cb9-59"><a href="#cb9-59" tabindex="-1"></a><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5]</span></span>
<span id="cb9-60"><a href="#cb9-60" tabindex="-1"></a><span class="co">#&gt;  [1,]    1    1   -1   -1    0</span></span>
<span id="cb9-61"><a href="#cb9-61" tabindex="-1"></a><span class="co">#&gt;  [2,]    1   -1   -1    1   -1</span></span>
<span id="cb9-62"><a href="#cb9-62" tabindex="-1"></a><span class="co">#&gt;  [3,]    1    0   -1   -1    1</span></span>
<span id="cb9-63"><a href="#cb9-63" tabindex="-1"></a><span class="co">#&gt;  [4,]    1   -1    1   -1   -1</span></span>
<span id="cb9-64"><a href="#cb9-64" tabindex="-1"></a><span class="co">#&gt;  [5,]    1    1    1    1    1</span></span>
<span id="cb9-65"><a href="#cb9-65" tabindex="-1"></a><span class="co">#&gt;  [6,]    1   -1   -1    1    1</span></span>
<span id="cb9-66"><a href="#cb9-66" tabindex="-1"></a><span class="co">#&gt;  [7,]   -1   -1    1   -1    1</span></span>
<span id="cb9-67"><a href="#cb9-67" tabindex="-1"></a><span class="co">#&gt;  [8,]   -1    0   -1    0   -1</span></span>
<span id="cb9-68"><a href="#cb9-68" tabindex="-1"></a><span class="co">#&gt;  [9,]    1    1    1   -1    1</span></span>
<span id="cb9-69"><a href="#cb9-69" tabindex="-1"></a><span class="co">#&gt; [10,]    1   -1   -1   -1   -1</span></span>
<span id="cb9-70"><a href="#cb9-70" tabindex="-1"></a><span class="co">#&gt; [11,]   -1   -1   -1   -1    1</span></span>
<span id="cb9-71"><a href="#cb9-71" tabindex="-1"></a><span class="co">#&gt; [12,]   -1    1    1    1    1</span></span>
<span id="cb9-72"><a href="#cb9-72" tabindex="-1"></a><span class="co">#&gt; [13,]   -1    1    1    1   -1</span></span>
<span id="cb9-73"><a href="#cb9-73" tabindex="-1"></a><span class="co">#&gt; [14,]   -1   -1   -1   -1   -1</span></span>
<span id="cb9-74"><a href="#cb9-74" tabindex="-1"></a><span class="co">#&gt; [15,]   -1   -1    1   -1   -1</span></span>
<span id="cb9-75"><a href="#cb9-75" tabindex="-1"></a><span class="co">#&gt; [16,]   -1   -1   -1    1    1</span></span>
<span id="cb9-76"><a href="#cb9-76" tabindex="-1"></a><span class="co">#&gt; [17,]   -1    1    0   -1    0</span></span>
<span id="cb9-77"><a href="#cb9-77" tabindex="-1"></a><span class="co">#&gt; [18,]   -1   -1    1    1   -1</span></span>
<span id="cb9-78"><a href="#cb9-78" tabindex="-1"></a><span class="co">#&gt; [19,]    0    1    1    0    0</span></span>
<span id="cb9-79"><a href="#cb9-79" tabindex="-1"></a><span class="co">#&gt; [20,]    0    0    0    1    1</span></span>
<span id="cb9-80"><a href="#cb9-80" tabindex="-1"></a><span class="co">#&gt; [21,]    1   -1    0   -1    1</span></span>
<span id="cb9-81"><a href="#cb9-81" tabindex="-1"></a><span class="co">#&gt; [22,]    1    1   -1    1   -1</span></span>
<span id="cb9-82"><a href="#cb9-82" tabindex="-1"></a><span class="co">#&gt; [23,]    1    0    1   -1   -1</span></span>
<span id="cb9-83"><a href="#cb9-83" tabindex="-1"></a><span class="co">#&gt; [24,]    1    1   -1    1    1</span></span>
<span id="cb9-84"><a href="#cb9-84" tabindex="-1"></a><span class="co">#&gt; [25,]    1   -1    1    0    1</span></span>
<span id="cb9-85"><a href="#cb9-85" tabindex="-1"></a><span class="co">#&gt; [26,]    1    1    1    1   -1</span></span>
<span id="cb9-86"><a href="#cb9-86" tabindex="-1"></a><span class="co">#&gt; [27,]   -1    1   -1    1   -1</span></span>
<span id="cb9-87"><a href="#cb9-87" tabindex="-1"></a><span class="co">#&gt; [28,]   -1    0    1    0    1</span></span>
<span id="cb9-88"><a href="#cb9-88" tabindex="-1"></a><span class="co">#&gt; [29,]    0    1    1   -1    1</span></span>
<span id="cb9-89"><a href="#cb9-89" tabindex="-1"></a><span class="co">#&gt; [30,]    0   -1    1    1    1</span></span>
<span id="cb9-90"><a href="#cb9-90" tabindex="-1"></a><span class="co">#&gt; [31,]   -1    1   -1   -1    1</span></span>
<span id="cb9-91"><a href="#cb9-91" tabindex="-1"></a><span class="co">#&gt; [32,]   -1    1    1   -1   -1</span></span>
<span id="cb9-92"><a href="#cb9-92" tabindex="-1"></a><span class="co">#&gt; [33,]    1    1   -1   -1   -1</span></span>
<span id="cb9-93"><a href="#cb9-93" tabindex="-1"></a><span class="co">#&gt; [34,]    1   -1    1    1    0</span></span>
<span id="cb9-94"><a href="#cb9-94" tabindex="-1"></a><span class="co">#&gt; [35,]    0   -1   -1   -1    0</span></span>
<span id="cb9-95"><a href="#cb9-95" tabindex="-1"></a><span class="co">#&gt; [36,]    0   -1    0    1   -1</span></span>
<span id="cb9-96"><a href="#cb9-96" tabindex="-1"></a><span class="co">#&gt; [37,]   -1    1   -1   -1   -1</span></span>
<span id="cb9-97"><a href="#cb9-97" tabindex="-1"></a><span class="co">#&gt; [38,]   -1   -1    0    0    0</span></span>
<span id="cb9-98"><a href="#cb9-98" tabindex="-1"></a><span class="co">#&gt; [39,]    0    0   -1    1    0</span></span>
<span id="cb9-99"><a href="#cb9-99" tabindex="-1"></a><span class="co">#&gt; [40,]    0    1    0    0   -1</span></span>
<span id="cb9-100"><a href="#cb9-100" tabindex="-1"></a><span class="co">#&gt; [41,]   -1   -1    0    1    0</span></span>
<span id="cb9-101"><a href="#cb9-101" tabindex="-1"></a><span class="co">#&gt; [42,]   -1    1   -1    0    1</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">options</span>(backup_options)</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
